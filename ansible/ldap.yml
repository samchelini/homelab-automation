---
- hosts: ldap
  roles:
    - extend-lvm
    - ldap 
  vars:
    common_name: '{{ "ldap." + domain_name }}'
    key_dir: /etc/ldap
    key_owner: openldap
    key_group: openldap
    domain_name: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          64663430323464343361623433333166343731663538333538313034313862333733386463306232
          3036666461323764323632356165363264626538633839660a346437643666613831336533326638
          34613032663138636266633933643431326533663061633435633239643363376131336234363161
          3464613239353439360a343566613330623434383739636431366333643633353464623031616337
          39383536383138323061343435623361633966336536343962623331653234633232
    dc: "{{ domain_name.split('.') | map('regex_replace', '^', 'dc=') | join(',') }}"
    organization: homelab
    admin_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          33383563353235663066376231353434306465353732656163626535643939393438656366336334
          3062316466383864313339626665326435313530613934620a303863313938653734373931303939
          38366333323262333530633634653364376135353139333233346162353331373061616330653566
          6436303635663764390a326364633664643736346164613965343965303030393838353938306162
          35613733303531356539373737656234656664313537333237333931636632643133393934623166
          6461666661396464383334373030643131666230323132623437
