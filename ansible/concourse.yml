---
- hosts: concourse
  roles:
    - extend-lvm
    - concourse
  vars:
    common_name: '{{ "concourse." + domain_name }}'
    key_dir: /opt/concourse/tls
    key_owner: concourse
    key_group: concourse
    domain_name: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          65356463613838386433333037656234653030613734663263373231343931666635326332623831
          3632653135643730333264666531656361626665663939350a323536366362636366313933353861
          32656461353739636535633762333733373332373239373830613531356332633633306561333632
          6137306633373465640a303430333133303936323330363164326434383966383631616165613131
          34636534343361616564663335316365353966343938636538356233386361326236
    dc: "{{ domain_name.split('.') | map('regex_replace', '^', 'dc=') | join(',') }}"
    readonly_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          31353363313032663633333061636230393436393661306637326538326336663836363131343333
          3164366164396130333363343836633061633261353361620a376133373738323164633064656134
          64336166363934353531316565373333623634383361366563313132323934346435633831303264
          6439666234623932610a376230653831383364396136626437666537623664643964396166373262
          6131
