---
- hosts: concourse
  gather_facts: false
  roles:
    - create_vm
    - extend-lvm
  vars:
    vm_name: concourse
    vm_memory_mb: 2048
    vm_cpu_num: 2
    vcenter_resource_pool: ops
    vm_network: ops
    vm_cidr: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          33343035633439366237666130643361386266306139396631373234666463383039373632646566
          6566303261626663363033353933653433316435366431360a613364353634656362663532616165
          38373733393538383933623739353430306238356236316132393632393937343132356466336364
          6165376235336239300a326332623662653136346361366632383331353938313135353962623133
          6334
    vm_gateway: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          61373132366164366666643830326532333539666435343939366232313239633639363938353035
          6363323132353739313638633565663430346665323664380a636262333332353763306534376136
          62623964313437373236393532363434343735353633633230633331383233626433633437346466
          3365303831373537650a333032623236643839313137336530653738616562666436373331613630
          3638

- hosts: concourse
  roles:
    - concourse
  vars:
    common_name: '{{ "concourse." + domain_name }}'
    key_dir: /opt/concourse/tls
    key_owner: concourse
    key_group: concourse
    domain_name: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          65356463613838386433333037656234653030613734663263373231343931666635326332623831
          3632653135643730333264666531656361626665663939350a323536366362636366313933353861
          32656461353739636535633762333733373332373239373830613531356332633633306561333632
          6137306633373465640a303430333133303936323330363164326434383966383631616165613131
          34636534343361616564663335316365353966343938636538356233386361326236
    dc: "{{ domain_name.split('.') | map('regex_replace', '^', 'dc=') | join(',') }}"
    readonly_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          31353363313032663633333061636230393436393661306637326538326336663836363131343333
          3164366164396130333363343836633061633261353361620a376133373738323164633064656134
          64336166363934353531316565373333623634383361366563313132323934346435633831303264
          6439666234623932610a376230653831383364396136626437666537623664643964396166373262
          6131
